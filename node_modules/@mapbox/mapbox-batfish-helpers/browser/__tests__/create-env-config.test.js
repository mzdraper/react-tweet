'use strict';

const createEnvConfig = require('../create-env-config');

describe('createEnvConfig', () => {
  test('works without additional entries in staging', () => {
    process.env.DEPLOY_ENV = 'staging';
    const result = createEnvConfig();
    expect(result).toEqual({
      API_URL_ORIGIN: 'https://cloudfront-staging.tilestream.net'
    });
  });

  test('works with additional entries in staging', () => {
    process.env.DEPLOY_ENV = 'staging';
    const result = createEnvConfig({
      FOO: {
        staging: 'foo',
        production: 'prod-foo'
      },
      BAR: {
        staging: 'bar',
        production: 'prod-bar'
      }
    });
    expect(result).toEqual({
      API_URL_ORIGIN: 'https://cloudfront-staging.tilestream.net',
      FOO: 'foo',
      BAR: 'bar'
    });
  });

  test('works without additional entries in production', () => {
    process.env.DEPLOY_ENV = 'production';
    const result = createEnvConfig();
    expect(result).toEqual({
      API_URL_ORIGIN: 'https://api.mapbox.com'
    });
  });

  test('works with additional entries in production', () => {
    process.env.DEPLOY_ENV = 'production';
    const result = createEnvConfig({
      FOO: {
        staging: 'foo',
        production: 'prod-foo'
      },
      BAR: {
        staging: 'bar',
        production: 'prod-bar'
      }
    });
    expect(result).toEqual({
      API_URL_ORIGIN: 'https://api.mapbox.com',
      FOO: 'prod-foo',
      BAR: 'prod-bar'
    });
  });
});
