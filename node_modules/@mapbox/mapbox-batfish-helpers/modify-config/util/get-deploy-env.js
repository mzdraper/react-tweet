'use strict';

const gitBranch = require('git-branch');
const constants = require('../constants');

module.exports = function getDeployEnv() {
  if (process.env.DEPLOY_ENV) {
    return process.env.DEPLOY_ENV;
  }
  try {
    const branch = gitBranch.sync();
    if (
      branch === 'mb-pages' ||
      branch === 'hey-pages' ||
      process.env.DEPLOY_ENV === 'production'
    ) {
      return constants.DEPLOY_ENV_PRODUCTION;
    }
  } catch (error) {
    // No Git branch.
  }
  return constants.DEPLOY_ENV_STAGING;
};
